run_name: tajalli_phase1_wt103_300k

# Data
cache_dir: data/cache
batch_size: 8
seq_len: 512
num_workers: 2
pin_memory: true
persistent_workers: true
seed: 1337

# Train length
max_steps: 300000
gradient_accumulation_steps: 4  # effective batch = batch_size * grad_accum
eval_every: 2000
checkpoint_every: 5000

# Optim
lr: 3.0e-4
weight_decay: 0.10
warmup_steps: 2000
min_lr_ratio: 0.10
grad_clip: 1.0

# Precision / device
device: cuda
dtype: bf16    # falls back safely if bf16 not available on your setup
amp: true

# Model (start with parity-ish defaults; tune later)
d_model: 512
n_heads: 8
d_head: 64
d_ff: 2048
d_essence: 256

n_steps: 6
n_inner_layers: 0
dropout: 0.0
max_seq_len: 512

# Essence
essence_init: spectral
essence_type: vector
n_essence_rows: 64
